■コンテナの基礎とDocker　― 実行単位が変わったという話 ―

節タイトル一覧
1.なぜ「実行単位」を見直す必要があったのか
2.仮想マシン（VM）が解決したこと、残した課題
3.コンテナとは何か ― 仮想マシンとの決定的な違い
4.アプリケーションを「単位」として扱うという発想
5.Docker の役割と位置づけ
6.コンテナ化とマイクロサービスは別の話
7.この章のまとめ ― 次に何が必要になるのか


1. なぜ「実行単位」を見直す必要があったのか
かつて、アプリケーションは「特定のサーバーにインストールして動かすもの」でした。

OS があり、ミドルウェアがあり、その上にアプリケーションが載る。
この構造は長い間、自然な前提として受け入れられてきました。

しかし、システムを取り巻く前提が変わるにつれ、この考え方は少しずつ無理を生み始めます。

・環境が増える
・変更の頻度が上がる
・同じものを、同じように動かしたい場面が増える

こうした状況の中で問題になったのは、
アプリケーションそのものではなく、
「それがどんな前提のもとで動くのか」が環境に強く依存していたことでした。

環境ごとの差異は、本来アプリケーションの本質とは関係がありません。
それでも現実には、

「あの環境では動いたのに、ここでは動かない」

という事象が、あたり前のように起こっていました。

ここで見直され始めたのが、アプリケーションをどの単位で扱っているのか という点です。


2. 仮想マシン（VM）が解決したこと、残した課題

この問題に対して、最初に大きな改善をもたらしたのが
仮想マシン（VM）による仮想化でした。

VMは、物理サーバーと OS の関係を切り離し、

・環境を複製できる
・移動できる
・障害時に戻せる

といった柔軟性をもたらします。

ここで重要なのは、VM は「失敗した技術」ではない という点です。
VMによって、「環境は固定されなくてよい」という前提は確実に手に入りました。

ただし一方で、アプリケーションの扱い方そのものは、ほとんど変わっていませんでした。

・OSごと抱え込む
・実行単位が大きい
・起動・破棄のコストが高い

つまりVMは、環境の抽象化には成功したが、実行単位としてはまだ重かった のです。


3. コンテナとは何か ― 仮想マシンとの決定的な違い
コンテナは、この「実行単位の重さ」に対する解答として登場します。

コンテナは、OS全体を複製するのではなく、

・アプリケーション
・依存関係
・実行に必要な前提条件

だけを一つの単位としてまとめます。

ここで重要なのは、コンテナの本質は「軽いこと」ではない という点です。

軽さや起動の速さは、「どこを単位として切り出したか」の結果にすぎません。

VMが「環境」を単位にしていたのに対し、コンテナは「アプリケーションが成立するための最小構成」
を単位として扱います。

この違いにより、アプリケーションは実行場所から切り離され、

・どこでも同じように動く
・必要になればすぐに作れる
・不要になればすぐに捨てられる

という前提を持つようになります。


4. アプリケーションを「単位」として扱うという発想
コンテナの導入によって変わったのは、ツールではなく アプリケーションの捉え方 です。

これまでは、アプリケーションは
「環境の上で動くもの」として扱われていました。

一方でコンテナでは、アプリケーションは
「自分が動くための前提を含んだ単位」として扱われます。

ここには、「長く動かし続ける」よりも「必要に応じて作り、壊せる」
ことを重視する発想があります。

つまりコンテナは、安定させるための技術ではなく、
変化を前提にするための技術なのです。


5. Docker の役割と位置づけ
この文脈でDockerを見ると、Dockerが何をした存在なのかが見えてきます。

Dockerは、コンテナという考え方を生み出した存在ではありません。

・コンテナを扱うための統一された操作体系
・再現可能なイメージという形式
・個人でも触れる敷居の低さ

を提供したことで、コンテナという概念を現実のものにしました。

Dockerは、クラウドネイティブそのものではありません。

ただし、そこへ至るための「入口」としては、
非常に重要な役割を果たした存在だと言えます。


ここから先は、「Docker = クラウドネイティブ」という誤解をどう壊すかを
もう一段詰める余地があると思っており、それがある程度形になったら文章化になりますね
ただ、6,7ともに概要は出来ているので、それは共有しておきます。


6. コンテナ化とマイクロサービスは別の話

▼レイヤー分離
・コンテナ：実行単位の話
・マイクロサービス：設計・組織の話
・なぜ混同されやすいのか

後続章での誤解を未然に防ぐ節


7. この章のまとめ ― 次に何が必要になるのか
▼次章への橋渡し）
・単位は切れた
・では、増えた単位をどうするのか？
・「制御」という新しい問題の登場

自然に「Kubernetes の話が必要だ」という状態を作る


▲章構成を貫く暗黙ルール
・Dockerfile は出さない
・コマンドは出さない
・数値比較はしない
・常に「なぜこの発想が必要になったか」に戻る
